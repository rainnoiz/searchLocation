<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <!--Theme JQuery-->
    <link href="Script/jquery-ui-1.10.3.custom/development-bundle/themes/base/jquery-ui.css" rel="stylesheet" />
    <script src="Script/jquery-ui-1.10.3.custom/js/jquery-1.9.1.js"></script>
    <script src="Script/jquery-ui-1.10.3.custom/js/jquery-ui-1.10.3.custom.js"></script>
    
    <!--Flexigrid-->  
    <link href="Plugin/Flexigrid-master/css/flexigrid.css" rel="stylesheet" />
    <script src="Plugin/Flexigrid-master/js/flexigrid.js"></script>

    <!--jqGrid-->
    <link href="Plugin/jqGrid/css/ui.jqgrid.css" rel="stylesheet" />
    <script src="Plugin/jqGrid/js/jquery.jqGrid.min.js"></script>

    <!--appendGrid-->
    <!--link href="Plugin/jQuery-Dynamic-Data-Grid-Plugin-appendGrid/jquery.appendGrid-1.3.0.css" rel="stylesheet" />
    <script src="Plugin/jQuery-Dynamic-Data-Grid-Plugin-appendGrid/jquery.appendGrid-1.3.0.js"></script-->
    <link href="Plugin/appendGrid/jquery.appendGrid-1.3.1.css" rel="stylesheet" />
    <script src="Plugin/appendGrid/jquery.appendGrid-1.3.1.js"></script>

    <!--Google Map API-->
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>


    <script>        //Google Map API
        var map;
        var markersSub = [];
        var markersCus = [];
        function initialize() {
            var haightAshbury = new google.maps.LatLng(13.75, 100.517);
            var mapOptions = {
                zoom: 6,
                center: haightAshbury,
                //mapTypeId: google.maps.MapTypeId.TERRAIN,
                draggable: true,
                animation: google.maps.Animation.DROP,
            };
            map = new google.maps.Map(document.getElementById('map-canvas'),
                mapOptions);
            
            //google.maps.event.addListener(map, 'click', function (event) {
            //    addMarker(event.latLng);
            //});
        }

        /*Add a marker to the map and push to the array.*/
        function AddMarkersSub() {
            var location = new google.maps.LatLng(13.75, 100.517);
            var markerSub = new google.maps.Marker({
                position: location,
                map: map,
                draggable: true,
                animation: google.maps.Animation.DROP,
                icon: 'Image/iconBlue.png'
            });
            markersSub.push(markerSub);         
        }
        function AddMarkersCus() {
            var location = new google.maps.LatLng(13.75, 100.517);
            var markerCus = new google.maps.Marker({
                position: location,
                map: map,
                draggable: true,
                animation: google.maps.Animation.DROP,
                icon: 'Image/iconPink.png'

            });
            markersCus.push(markerCus);
        }

        /*Delete all markers*/
        function DeleteAllMarkers() {
            //Delete markers
            for (var i = 0; i < markersSub.length; i++) {
                markersSub[i].setMap(null);
            }
            for (var i = 0; i < markersCus.length; i++) {
                markersCus[i].setMap(null);
            }
            markersSub = [];
            markersCus = [];

            //Delete row
            DeleteAllRows();
        }

        /*Delete row supplier*/
        function DeleteMapSup(id) {
            markersSub[id].setMap(null);
        }

        /*Delete row customer*/
        function DeleteMapCus(id) {
            markersCus[id].setMap(null);
        }


        // Dragable marker
        function toggleBounce() {

            if (markers.getAnimation() != null) {
                markers.setAnimation(null);
            } else {
                marker.setAnimation(google.maps.Animation.BOUNCE);
            }
        }

        google.maps.event.addDomListener(window, 'load', initialize);

    </script>

    <script>//Button
         $(function () {
             $("button")
             .button()
             .click(function (event) {
                 event.preventDefault();
             });
         });
    </script>

    <script type="text/javascript">//Grid Table
        /* flexiGrid
        jQuery(document).ready(function ($) {
            $('.flexme1').flexigrid();
        });
        
        jQuery(document).ready(function ($) {
            $(".flexme1").flexigrid({
                url: 'post2.php',
                dataType: 'json',
                colModel: [
                    { display: 'Supplier Name', name: 'supName', width: 180, sortable: true, align: 'left' },
                    { display: 'Cost', name: 'cost', width: 120, sortable: true, align: 'left' },
                    { display: 'Volumn', name: 'valumn', width: 130, sortable: true, align: 'left' },
                    { display: 'Location Point', name: 'localPoint', width: 80, sortable: true, align: 'right' }
                ],
                searchitems: [
                    { display: 'Supplier Name', name: 'subName' }
                ],
                sortname: "supName",
                sortorder: "asc",
                showTableToggleBtn: true,
                width: 'auto',
                //onSubmit: addFormData,
                height: 200
            });
        });
        */

        /* jqGrid
        jQuery(document).ready(function ($) {
        var data = [[48803, "DSK1", "", "02200220", "OPEN"], [48769, "APPR", "", "77733337", "ENTERED"]];

        $("#grid").jqGrid({
            datatype: "local",
            height: 250,
            colNames: ['Inv No', 'Thingy', 'Blank', 'Number', 'Status'],
            colModel: [{
                name: 'id',
                index: 'id',
                width: 60,
                sorttype: "int"
            },
            {
                name: 'thingy',
                index: 'thingy',
                width: 90,
                sorttype: "date"
            },
            {
                name: 'blank',
                index: 'blank',
                width: 30
            },
            {
                name: 'number',
                index: 'number',
                width: 80,
                sorttype: "float"
            },
            {
                name: 'status',
                index: 'status',
                width: 80,
                sorttype: "float"
            }
            ],
            caption: "Stack Overflow Example",
            // ondblClickRow: function(rowid,iRow,iCol,e){alert('double clicked');}
        });

        var names = ["id", "thingy", "blank", "number", "status"];
        var mydata = [];

        for (var i = 0; i < data.length; i++) {
            mydata[i] = {};
            for (var j = 0; j < data[i].length; j++) {
                mydata[i][names[j]] = data[i][j];
            }
        }

        for (var i = 0; i <= mydata.length; i++) {
            $("#grid").jqGrid('addRowData', i + 1, mydata[i]);
        }

       //$("#grid").jqGrid('setGridParam', {onSelectRow: function(rowid,iRow,iCol,e){alert('row clicked');}});

        $("#grid").jqGrid('setGridParam', { ondblClickRow: function (rowid, iRow, iCol, e) { alert('double clicked'); } });

        });
        */
        </script>

    <script>
        /* appendGrid */
        jQuery(document).ready(function ($) {
            $(function () {

                /*Supplier*/
                $('#gridSupplier').appendGrid({
                    initRows: 0,
                    columns: [
                    { name: 'subName', display: 'Name', type: 'text', ctrlAttr: { maxlength: 200 }, ctrlCss: { width: '100%' } },
                    { name: 'subCost', display: 'Costs', type: 'text', ctrlAttr: { maxlength: 100 }, ctrlCss: { width: '100%' } },
                    { name: 'subQuantity', display: 'Quantities', type: 'text', ctrlAttr: { maxlength: 100 }, ctrlCss: { width: '100%' } },
                    { name: 'subLat', display: 'Latitude(X)', type: 'text', ctrlAttr: { maxlength: 100 }, ctrlCss: { width: '100%' } },
                    { name: 'subLong', display: 'Longtitude(Y)', type: 'text', ctrlAttr: { maxlength: 100 }, ctrlCss: { width: '100%' } },
                    { name: 'subRecordId', type: 'hidden', value: 0 }
                    ],
                    customRowButtons: [
                        {
                            uiButton: { icons: { primary: 'ui-icon-trash' } },
                            click: function (evtObj, uniqueIndex, rowData) {
                                DeleteRowSub(uniqueIndex);
                                DeleteMapSup(uniqueIndex-1);
                            }
                        }
                    ],
                    customFooterButtons: [
                        {
                            uiButton: { icons: { primary: 'ui-icon-plusthick' } },
                            btnCss: { 'color': '#ff0000' },
                            btnClass: 'append',
                            click: function (evt)
                            {
                                InsertRow(1);
                            },
                            atTheFront: true
                        }
                    ],
                    caption: null,
                    hideRowNumColumn: true,
                    hideButtons: {
                        moveUp:true,
                        moveDown: true,
                        insert: true,
                        remove: true,
                        removeLast: true,
                        append:true
                    }
                });

                /*Customer*/
                $('#gridCustomer').appendGrid({
                    caption: 'My CD Collections',
                    initRows: 0,
                    columns: [
                    {
                        name: 'cusName', display: 'Name', type: 'text', ctrlAttr: { maxlength: 200 }, ctrlCss: { width: '100%' }
                        /*,
                        onClick: function (evt, rowIndex) {
                            alert(rowIndex);
                        }
                        */
                    },
                    { name: 'cusCost', display: 'Costs', type: 'text', ctrlAttr: { maxlength: 100 }, ctrlCss: { width: '100%' } },
                    { name: 'cusQuantity', display: 'Quantities', type: 'text', ctrlAttr: { maxlength: 100 }, ctrlCss: { width: '100%' } },
                    { name: 'cusLat', display: 'Latitude(X)', type: 'text', ctrlAttr: { maxlength: 100 }, ctrlCss: { width: '100%' } },
                    { name: 'cusLong', display: 'Longtitude(Y)', type: 'text', ctrlAttr: { maxlength: 100 }, ctrlCss: { width: '100%' } },
                    { name: 'cusRecordId', type: 'hidden', value: 0 }
                    ],
                    customRowButtons: [
                            {
                                uiButton: { icons: { primary: 'ui-icon-trash' } },
                                click: function (evtObj, uniqueIndex, rowData)
                                {
                                    DeleteRowCus(uniqueIndex);
                                    DeleteMapCus(uniqueIndex - 1);
                                }
                            }
                    ],
                    customFooterButtons: [
                        {
                            uiButton: { icons: { primary: 'ui-icon-plusthick' } },
                            btnCss: { 'color': '#ff0000' },
                            btnClass: 'append',
                            click: function (evt) {
                                InsertRow(2);
                            },
                            atTheFront: true
                        }
                    ],
                    caption: null,
                    hideRowNumColumn: true,
                    hideButtons: {
                        moveUp: true,
                        moveDown: true,
                        insert: true,
                        remove: true,
                        removeLast: true,
                        append: true
                    }
                });
            });
        });
    </script>

    <script type="text/javascript">

        /*Calculate location*/
        function Submit() {
            var dataSub = $('#gridSupplier').appendGrid('getAllValue');
            alert("The data is : " + dataSub[0].subName);
        }
        /*Inser row and marker*/
        function InsertRow(type) {
            //var idMarker = $('#gridSupplier').appendGrid('insertRow', 1, 2);
            if (type == 1) {
                $('#gridSupplier').appendGrid('insertRow', 1, 2);
                AddMarkersSub();
            }
            else {
                $('#gridCustomer').appendGrid('insertRow', 1, 2);
                AddMarkersCus();
            }
        }
        /*Delete row for supplier*/
        function DeleteRowSub(uniqueIndex) {
            var rowIndex = $('#gridSupplier').appendGrid('getRowIndex', uniqueIndex);
            $('#gridSupplier').appendGrid('removeRow', rowIndex, uniqueIndex);
        }
        /*Delete row for customer*/
        function DeleteRowCus(uniqueIndex) {
            var rowIndex = $('#gridCustomer').appendGrid('getRowIndex', uniqueIndex);
            $('#gridCustomer').appendGrid('removeRow', rowIndex, uniqueIndex);
        }

        function DeleteAllRows()
        {
            var rowCountSub = $('#gridSupplier').appendGrid('getRowCount');
            if (rowCountSub > 0) {
                for (var i = 0; i < rowCountSub; i++) {
                    $('#gridSupplier').appendGrid('removeRow', 0);
                }
            }

            var rowCountCus = $('#gridCustomer').appendGrid('getRowCount');
            if (rowCountCus > 0) {
                for (var i = 0; i < rowCountCus; i++) {
                    $('#gridCustomer').appendGrid('removeRow', 0);
                }
            }
        }

        /*
        function TestAlert() {
            alert("Click column");
        }
        */
    </script>

  </head>
  <body>
      <section id="secMap">
          <article id="map-canvas"></article>
      </section>

      <section id="secCal"  class="ui-accordion ui-widget ui-helper-reset" role="tablist">
        <h3 id="ui-accordion-accordion-header-0" class="ui-accordion-header ui-helper-reset ui-state-default ui-corner-all ui-accordion-icons" role="tab" aria-controls="ui-accordion-accordion-panel-0" aria-selected="true" tabindex="0">
          <a href="#" style="font-weight: bold">Supplier</a>
        </h3>
        <article id="ui-accordion-accordion-panel-0" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content-active" style="display: block;" aria-labelledby="ui-accordion-accordion-header-0" role="tabpanel" aria-expanded="true" aria-hidden="false">
            <table id="gridSupplier"></table>
        </article>
        
        <h3 id="ui-accordion-accordion-header-1" class="ui-accordion-header ui-helper-reset ui-state-default ui-corner-all ui-accordion-icons" role="tab" aria-controls="ui-accordion-accordion-panel-0" aria-selected="true" tabindex="0">
          <a href="#" style="font-weight: bold">Customer</a>
        </h3>
          <article id="ui-accordion-accordion-panel-1" class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content-active" style="display: block;" aria-labelledby="ui-accordion-accordion-header-1" role="tabpanel" aria-expanded="true" aria-hidden="false">
          <table id="gridCustomer"></table>
        </article>

        <section id="button">
          <button id="btnSubmit" onclick="Submit();">Find Location</button>
          <button id="Button1" onclick="DeleteAllMarkers();">Clear</button>
        </section>
      </section>

  </body>
</html>

    